<!--
http://alangrafu.github.io/radar-chart-d3/csv2radar.html
Data Layout:
id	name	artists	danceability	energy	key	loudness	mode	speechiness	acousticness	instrumentalness	liveness	valence	tempo	duration_ms	time_signature
7qiZfU4dY1lWllzX7mPBI	Shape of You	Ed Sheeran	0.825	0.652	1	-3.183	0	0.0802	0.581	0	0.0931	0.931	95.977	233713	4
-->
<!--
Reference: https://jrue.github.io/coding/2014/exercises/basicbubblepackchart/
-->
<!doctype html>
<html lang="en">
<head>
   <!-- Required meta tags -->
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

   <!-- Bootstrap CSS -->
   <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">

   <title>Hello, world!</title>

</head>
<body>
   <div class="radarChart"></div>
</body>

<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

<!-- d3 -->
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="radarChart.js"></script>
<script type="text/javascript">
var convertedData
d3.csv("data/top_spotify_tracks_2017.csv", function(data) {
   data = data.map(function(d){
      return d
   })
   var row
   var newArray = []
   for(i=0;i<Object.keys(data).length;i++){
      row = {
         axis: "danceability",
         // convert strings to numbers
         // normalize data with range 0 to 1
         value: +data[i].danceability/d3.max(data,function(d){
            return d.danceability
         })
      }
      newArray.push(row)
      row = {
         axis: "energy",
         value: +data[i].energy/d3.max(data,function(d){
            return d.energy
         })
      }
      newArray.push(row)
      row = {
         axis: "key",
         value: +data[i].key/d3.max(data,function(d){
            return d.key
         })
      }
      newArray.push(row)
      row = {
         // loudness is negative, make positive
         axis: "loudness",
         value: -data[i].loudness/d3.max(data,function(d){
            return -d.loudness
         })
      }
      newArray.push(row)
      row = {
         axis: "mode",
         value: +data[i].mode/d3.max(data,function(d){
            return d.mode
         })
      }
      newArray.push(row)
      row = {
         axis: "speechiness",
         value: +data[i].speechiness/d3.max(data,function(d){
            return d.speechiness
         })
      }
      newArray.push(row)
      row = {
         axis: "acousticness",
         value: +data[i].acousticness/d3.max(data,function(d){
            return d.acousticness
         })
      }
      newArray.push(row)
      row = {
         axis: "instrumentalness",
         value: +data[i].instrumentalness/d3.max(data,function(d){
            return d.instrumentalness
         })
      }
      newArray.push(row)
      row = {
         axis: "liveness",
         value: +data[i].liveness/d3.max(data,function(d){
            return d.liveness
         })
      }
      newArray.push(row)
      row = {
         axis: "valence",
         value: +data[i].valence/d3.max(data,function(d){
            return d.valence
         })
      }
      newArray.push(row)
      row = {
         axis: "tempo",
         value: +data[i].tempo/d3.max(data,function(d){
            return d.tempo
         })
      }
      newArray.push(row)
      row = {
         axis: "duration_ms",
         value: +data[i].duration_ms/d3.max(data,function(d){
            return d.duration_ms
         })
      }
      newArray.push(row)
   }
   convertedData = newArray.splice(0,5)
   convertedData = [convertedData]

   /* Radar chart design created by Nadieh Bremer - VisualCinnamon.com */

   //////////////////////////////////////////////////////////////
   //////////////////////// Set-Up //////////////////////////////
   //////////////////////////////////////////////////////////////

   var margin = {top: 100, right: 100, bottom: 100, left: 100},
   width = Math.min(700, window.innerWidth - 10) - margin.left - margin.right,
   height = Math.min(width, window.innerHeight - margin.top - margin.bottom - 20);

   //////////////////////////////////////////////////////////////
   ////////////////////////// Data //////////////////////////////
   //////////////////////////////////////////////////////////////


   //////////////////////////////////////////////////////////////
   //////////////////// Draw the Chart //////////////////////////
   //////////////////////////////////////////////////////////////

   var color = d3.scale.ordinal()
   .range(["#EDC951","#CC333F","#00A0B0"]);

   var radarChartOptions = {
      w: width,
      h: height,
      margin: margin,
      maxValue: 0.5,
      levels: 5,
      roundStrokes: true,
      color: color
   };
   //Call function to draw the Radar chart
   RadarChart(".radarChart", convertedData, radarChartOptions);
}) // end d3.csv()

</script>

</html>
