<!--
http://alangrafu.github.io/radar-chart-d3/csv2radar.html
http://bl.ocks.org/nbremer/21746a9668ffdf6d8242
-->
<!doctype html>
<html lang="en">
<head>
   <!-- Required meta tags -->
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

   <!-- Bootstrap CSS -->
   <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">

   <title>Hello, world!</title>

</head>
<body>
   <div class="radarChart"></div>
</body>

<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

<!-- d3 -->
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="radarChart.js"></script>
<script type="text/javascript">
var convertedData = {}
d3.csv("data/top_spotify_tracks_2017.csv", function(data) {
   data = data.map(function(d){
      return d
   })
   console.log(d3.max(data, function(d) { return +d.danceability} ))
   var row
   var newArray = []

   for(i=0;i<5;i++){
console.log(+data[i].danceability/d3.max(data, function(d) { return +d.danceability}))
      entry = [
         {
            axis: "danceability",
            // normalize values to scale from 0 to 1
            value: +data[i].danceability/d3.max(data, function(d) {
               return +d.danceability
            })
         },
         {
            axis: "energy",
            // normalize values to scale from 0 to 1
            value: +data[i].energy/d3.max(data, function(d){
               return +d.energy
            })
         },
         {
            axis: "key",
            // normalize values to scale from 0 to 1
            value: +data[i].key/d3.max(data, function(d){
               return +d.key
            })
         },
         {
            axis: "loudness",
            // normalize values to scale from 0 to 1
            // loudness is negative, convert to positive
            value: -data[i].loudness/d3.max(data, function(d){
               return -d.loudness
            })
         },
         {
            axis: "mode",
            // normalize values to scale from 0 to 1
            value: +data[i].mode/d3.max(data, function(d){
               return +d.mode
            })
         },
         {
            axis: "speechiness",
            // normalize values to scale from 0 to 1
            value: +data[i].speechiness/d3.max(data, function(d){
               return +d.speechiness
            })
         },
         {
            axis: "acousticness",
            // normalize values to scale from 0 to 1
            value: +data[i].acousticness/d3.max(data, function(d){
               return +d.acousticness
            })
         },
         {
            axis: "instrumentalness",
            // normalize values to scale from 0 to 1
            value: +data[i].instrumentalness/d3.max(data, function(d){
               return +d.instrumentalness
            })
         },
         {
            axis: "liveness",
            // normalize values to scale from 0 to 1
            value: +data[i].liveness/d3.max(data, function(d){
               return +d.liveness
            })
         },
         {
            axis: "valence",
            // normalize values to scale from 0 to 1
            value: +data[i].valence/d3.max(data, function(d){
               return +d.valence
            })
         },
         {
            axis: "tempo",
            // normalize values to scale from 0 to 1
            value: +data[i].tempo/d3.max(data, function(d) {
               return +d.tempo
            })
         },
         {
            axis: "duration_ms",
            // normalize values to scale from 0 to 1
            value: +data[i].duration_ms/d3.max(data, function(d) {
               return +d.duration_ms
            })
         },
      ]
      newArray.push(entry)
   }
      console.log(newArray)
      convertedData = newArray
//convertedData = Object.entries(convertedData)


/* Radar chart design created by Nadieh Bremer - VisualCinnamon.com */

//////////////////////////////////////////////////////////////
//////////////////////// Set-Up //////////////////////////////
//////////////////////////////////////////////////////////////

var margin = {top: 100, right: 100, bottom: 100, left: 100},
width = Math.min(700, window.innerWidth - 10) - margin.left - margin.right,
height = Math.min(width, window.innerHeight - margin.top - margin.bottom - 20);

//////////////////////////////////////////////////////////////
////////////////////////// Data //////////////////////////////
//////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////
//////////////////// Draw the Chart //////////////////////////
//////////////////////////////////////////////////////////////

var color = d3.scale.ordinal()
.range(["#EDC951","#CC333F","#00A0B0"]);

var radarChartOptions = {
   w: width,
   h: height,
   margin: margin,
   maxValue: 0.5,
   levels: 5,
   roundStrokes: true,
   color: color
};
//Call function to draw the Radar chart
RadarChart(".radarChart", convertedData, radarChartOptions);
}) // end d3.csv()

</script>

</html>
